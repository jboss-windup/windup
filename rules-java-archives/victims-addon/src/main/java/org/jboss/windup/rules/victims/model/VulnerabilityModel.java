package org.jboss.windup.rules.victims.model;

import com.tinkerpop.blueprints.Direction;
import com.tinkerpop.frames.Adjacency;
import com.tinkerpop.frames.Property;
import com.tinkerpop.frames.modules.typedgraph.TypeValue;
import org.jboss.windup.graph.model.WindupVertexFrame;
import org.jboss.windup.rules.apps.java.model.JarArchiveModel;

/**
 * A CVE vulnerability attached to an archive.
 * Added by the Victims addon to AffectedJarModel.
 *
 * @see http://cve.mitre.org/
 * @author <a href="http://ondra.zizka.cz/">Ondrej Zizka, zizka@seznam.cz</a>
 */
@TypeValue(VulnerabilityModel.TYPE)
public interface VulnerabilityModel extends WindupVertexFrame
{
    static final String TYPE = "victims:vulnerability";
    static final String LABEL_AFFECTED_BY = "affectedBy";
    static final String KEY_CVE = "cve";

    /**
     * A CVE ID, for example: CVE-2014-7654321 .
     * A link created from ID: "http://cve.mitre.org/cgi-bin/cvename.cgi?name=" + CVE-ID.
     *
     * @see http://cve.mitre.org/
     */
    @Property(KEY_CVE)
    public String getCve();

    /**
     * A CVE ID, for example: CVE-2014-7654321 .
     * A link created from ID: "http://cve.mitre.org/cgi-bin/cvename.cgi?name=" + CVE-ID.
     *
     * @see http://cve.mitre.org/
     */
    @Property(KEY_CVE)
    public VulnerabilityModel setCve(String cve);


    /**
     * The archive affected by this vulnerability.
     * This is 1:1 relation, so multiple instances of this with same CVE may exist for different archives.
     */
    @Adjacency(label = LABEL_AFFECTED_BY, direction = Direction.IN)
    public JarArchiveModel getArchive();

    /**
     * Sets the archive affected by this vulnerability.
     * This is 1:1 relation, so multiple instances of this with same CVE may exist for different archives.
     */
    @Adjacency(label = LABEL_AFFECTED_BY, direction = Direction.IN)
    public VulnerabilityModel setArchive(JarArchiveModel archive);

}
