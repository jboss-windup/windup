<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:windup="http://www.jboss.org/schema/windup"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.jboss.org/schema/windup http://www.jboss.org/schema/windup.xsd">

    <windup:pipeline type="XML" id="hornetq-config-decorators">
        <!--  -->
        <windup:xpath-classification description="HornetQ Configuration"
                                     xpath="/server/mbean[@name='jboss.messaging:service=ServerPeer']"
                                     effort="0">
            <windup:decorators>
                <windup:link url="http://documentation-devel.engineering.redhat.com/docs/en-US/JBoss_Enterprise_Application_Platform/5/html-single/HornetQ_User_Guide/index.html#idm89903344"
                             description="HornetQ User Guide - section 2.5 Server Configuration Migration" />
            </windup:decorators>
        </windup:xpath-classification>

        <windup:file-gate regex="messaging-service.xml">
                <windup:decorators>
                    <windup:xslt-transform location="transformations/xslt/jboss-messaging-to-hornetq.xsl"
                                           description="JBoss Messaging and MQ Configuration to HornetQ Configuration Transform"
                                           extension="-hornetq-config.xml"/>
                </windup:decorators>
        </windup:file-gate>

    </windup:pipeline>



    <!-- ################ Java Code Rules ################ -->
    <windup:java-hints id="jboss-messaging-to-hornetq-classname-equivalents">

        <windup:java-hint source-type="IMPORT" regex="org.jboss.jms.client.JBossConnectionFactory$" hint="Migrate to HornetQ: org.hornetq.jms.client.HornetQConnectionFactory" effort="1"/>
        <windup:java-hint source-type="IMPORT"  regex="org.jboss.jms.client.JBossConnection$" hint="Migrate to HornetQ: org.hornetq.jms.client.HornetQConnection" effort="1"/>
        <windup:java-hint source-type="IMPORT"  regex="org.jboss.jms.client.JBossSession" hint="Migrate to HornetQ: org.hornetq.jms.client.HornetQSession" effort="1"/>
        <windup:java-hint source-type="IMPORT"  regex="org.jboss.jms.client.JBossMessageProducer" hint="Migrate to HornetQ: org.hornetq.jms.client.HornetQMessageProducer" effort="1"/>
        <windup:java-hint source-type="IMPORT" regex="org.jboss.jms.client.JBossMessageConsumer" hint="Migrate to HornetQ: org.hornetq.jms.client.HornetQMessageConsumer" effort="1"/>



        <windup:java-hint source-type="CONSTRUCT" regex="JBossConnectionFactory" effort="1">
            <![CDATA[
                Select appropriate replacement:

                http://docs.jboss.org/hornetq/2.3.0.beta3/docs/api/hornetq-jms-client/org/hornetq/jms/client/HornetQConnectionFactory.html
            ]]>
        </windup:java-hint>

        <windup:java-hint source-type="CONSTRUCT"  regex="JBossConnection\b" effort="1">
            <![CDATA[
                Replace with constructor:

                HornetQConnection(String username, String password, int connectionType, String clientID, int dupsOKBatchSize, int transactionBatchSize, ClientSessionFactory sessionFactory)

            ]]>
        </windup:java-hint>

        <windup:java-hint source-type="CONSTRUCT"  regex="JBossSession" effort="1">
            <![CDATA[
                Replace with constructor:

                HornetQSession(HornetQConnection connection, boolean transacted, boolean xa, int ackMode, ClientSession session, int sessionType)
            ]]>
        </windup:java-hint>

        <windup:java-hint source-type="CONSTRUCT"  regex="JBossMessageProducer" effort="1">
            <![CDATA[
                Replace with constructor:

                HornetQMessageProducer(HornetQConnection jbossConn, ClientProducer producer, HornetQDestination defaultDestination, ClientSession clientSession)
            ]]>
        </windup:java-hint>

        <windup:java-hint source-type="CONSTRUCT" regex="JBossMessageConsumer" effort="1">
            <![CDATA[
                Replace with constructor:

                HornetQMessageConsumer(HornetQSession session, ClientConsumer consumer, boolean noLocal, HornetQDestination destination, String selector, SimpleString autoDeleteQueueName)
            ]]>
        </windup:java-hint>

    </windup:java-hints>

    <!-- -->
    <windup:pipeline type="JAVA" id="hornetq-classname-docs">
        <windup:java-classification source-type="IMPORT"
                                    regex="((JBossConnectionFactory)|(JBossConnection)|(JBossSession)|(JBossMessageProducer)|(JBossMessageConsumer))$"
                                    description="HornetQ configuration" effort="1">
            <windup:decorators>
                <windup:link url="http://documentation-devel.engineering.redhat.com/docs/en-US/JBoss_Enterprise_Application_Platform/5/html-single/HornetQ_User_Guide/index.html#idm89157152"
                             description="HornetQ User Guide - section 2.2 Application Code" />
            </windup:decorators>

        </windup:java-classification>
    </windup:pipeline>


    <!-- ################ JMS Rules ################ -->

    <windup:pipeline type="XML" id="hornetq-jms-config-decorators">

        <windup:xpath-classification description="JBoss Message JNDI bindings"
                                     xpath="//*[@name='JNDIBindings']">

            <windup:decorators>

                <windup:xpath-value description="HornetQ remapping required for JNDIBindings."
                                    xpath="//*[@name='JNDIBindings']"
                                    effort="0" inline="true"/>

                <windup:xpath-value description="HornetQ remapping required for PrefetchSize."
                                    xpath="//*[@name='PrefetchSize']"
                                    effort="0" inline="true"/>

                <windup:xpath-value description="HornetQ remapping required for SendAcksAsync."
                                    xpath="//*[@name='SendAcksAsync']"
                                    effort="0" inline="true"/>


                <windup:xpath-value description="HornetQ remapping required for DupsOKBatchSize."
                                    xpath="//*[@name='DupsOKBatchSize']"
                                    effort="0" inline="true"/>


                <windup:xpath-value description="HornetQ remapping required for LoadBalancingFactory."
                                    xpath="//*[@name='LoadBalancingFactory']"
                                    effort="0" inline="true"/>

                <windup:link url="http://documentation-devel.engineering.redhat.com/docs/en-US/JBoss_Enterprise_Application_Platform/5/html-single/HornetQ_User_Guide/index.html#idm89903344
"
                             description="HornetQ User Guide - section 2.6. Migrating JMS-administered Objects and Bridges" />
            </windup:decorators>
        </windup:xpath-classification>

    </windup:pipeline>

</beans>
