<!DOCTYPE html>
<html lang="en">


  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Source Report for JMSSink.java</title>
    <link href="resources/css/bootstrap.min.css" rel="stylesheet">
    <link href="resources/css/windup.css" rel="stylesheet" media="screen">
	  <link rel='stylesheet' type='text/css' href='resources/libraries/snippet/jquery.snippet.min.css' />
	  <link rel='stylesheet' type='text/css' href='resources/css/windup-source.css' />
	  <link rel='stylesheet' type='text/css' href='resources/libraries/sausage/sausage.css' />
  </head>
  <body role="document">
    
    <!-- Fixed navbar -->
    <div class="navbar-fixed-top windup-bar" role="navigation">
      <div class="container theme-showcase" role="main">
        <img src="resources/img/windup-logo.png" class="logo"/>
      </div>
    </div>


    <div class="container" role="main">
        <div class="row">
          <div class="page-header page-header-no-border">
            <h1>
              Source Report
              <span class="slash">/</span>
              <small style="margin-left: 20px; font-weight: 100;">jee-example-app-1.0.0.ear/log4j-1.2.6.jar/org/apache/log4j/net/JMSSink.java</small>
            </h1>
            <div class="navbar navbar-default">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <div class="navbar-collapse collapse navbar-responsive-collapse">
	     <ol class="breadcrumb top-menu">
		<li><a href="../index.html">All Applications</a></li>
  <li><a href="JEE_Example_App__org_windup_example_jee_example_app_1_0_0_.1.html">JEE Example App (org.windup.example:jee-example-app:1.0.0)</a></li>
  
  <li><a href="JMSSink_java.2.html">JMSSink.java</a></li>
  
	     </ol> 
            </div>
            <div class="navbar-collapse collapse navbar-responsive-collapse">
              <ul class="nav navbar-nav">
  <li><a href="JEE_Example_App__org_windup_example_jee_example_app_1_0_0_.1.html">Overview</a></li>
  <li><a href="ignoredfiles_JEE_Example_App__org_windup_example_jee_example_app_1_0_0_.1.html">Ignored Files</a></li>
  <li><a href="nonclassifiedfiles_JEE_Example_App__org_windup_example_jee_example_app_1_0_0_.1.html">Unclassified Files</a></li>
              </ul>
            </div><!-- /.nav-collapse -->
            </div>
          </div>
        </div>
    </div>



    <div class="container theme-showcase" role="main">

    <div class="panel panel-default">
    	<div class="panel-heading">Information</div>
    	<div class="panel-body">
	        <ul>
	          <li>Estimated Story Points: 1</li>
		          <li>
	              		<span class="label label-info">Decompiled Java File</span>
	              		<span class="label label-info">Java Source</span>
	              </li>
            </ul>
        
            <ul>
            </ul>
		</div>
      </div>
    
    

<pre id='source'>package org.apache.log4j.net;

import javax.jms.MessageConsumer;
import javax.jms.Connection;
import javax.naming.NamingException;
import javax.naming.NameNotFoundException;
import javax.jms.JMSException;
import org.apache.log4j.spi.LoggingEvent;
import javax.jms.ObjectMessage;
import javax.jms.Message;
import javax.jms.TopicConnection;
import javax.jms.Topic;
import javax.naming.Context;
import javax.jms.TopicConnectionFactory;
import javax.naming.InitialContext;
import java.io.Reader;
import java.io.BufferedReader;
import java.io.InputStreamReader;
import org.apache.log4j.PropertyConfigurator;
import org.apache.log4j.xml.DOMConfigurator;
import org.apache.log4j.Logger;
import javax.jms.MessageListener;

public class JMSSink implements MessageListener{
    static Logger logger;
    static /* synthetic */ Class class$org$apache$log4j$net$JMSSink;
    public static void main(final String[] array) throws Exception{
        if(array.length!=5){
            usage(&quot;Wrong number of arguments.&quot;);
        }
        final String s=array[0];
        final String s2=array[1];
        final String s3=array[2];
        final String s4=array[3];
        final String s5=array[4];
        if(s5.endsWith(&quot;.xml&quot;)){
            new DOMConfigurator();
            DOMConfigurator.configure(s5);
        }
        else{
            new PropertyConfigurator();
            PropertyConfigurator.configure(s5);
        }
        new JMSSink(s,s2,s3,s4);
        final BufferedReader bufferedReader=new BufferedReader(new InputStreamReader(System.in));
        System.out.println(&quot;Type \&quot;exit\&quot; to quit JMSSink.&quot;);
        while(!bufferedReader.readLine().equalsIgnoreCase(&quot;exit&quot;)){
        }
        System.out.println(&quot;Exiting. Kill the application if it does not exit due to daemon threads.&quot;);
    }
    public JMSSink(final String s,final String s2,final String s3,final String s4){
        super();
        try{
            final InitialContext initialContext=new InitialContext();
            final TopicConnection topicConnection=((TopicConnectionFactory)lookup(initialContext,s)).createTopicConnection(s3,s4);
            ((Connection)topicConnection).start();
            ((MessageConsumer)topicConnection.createTopicSession(false,1).createSubscriber((Topic)initialContext.lookup(s2))).setMessageListener((MessageListener)this);
        }
        catch(Exception t){
            JMSSink.logger.error(&quot;Could not read JMS message.&quot;,t);
        }
    }
    public void onMessage(final Message message){
        try{
            if(message instanceof ObjectMessage){
                final LoggingEvent event=(LoggingEvent)((ObjectMessage)message).getObject();
                Logger.getLogger(event.getLoggerName()).callAppenders(event);
            }
            else{
                JMSSink.logger.warn(&quot;Received message is of type &quot;+message.getJMSType()+&quot;, was expecting ObjectMessage.&quot;);
            }
        }
        catch(JMSException t){
            JMSSink.logger.error(&quot;Exception thrown while processing incoming message.&quot;,(Throwable)t);
        }
    }
    protected static Object lookup(final Context context,final String s) throws NamingException{
        try{
            return context.lookup(s);
        }
        catch(NameNotFoundException ex){
            JMSSink.logger.error(&quot;Could not find name [&quot;+s+&quot;].&quot;);
            throw ex;
        }
    }
    static void usage(final String s){
        System.err.println(s);
        System.err.println(&quot;Usage: java &quot;+((JMSSink.class$org$apache$log4j$net$JMSSink==null)?(JMSSink.class$org$apache$log4j$net$JMSSink=class$(&quot;org.apache.log4j.net.JMSSink&quot;)):JMSSink.class$org$apache$log4j$net$JMSSink).getName()+&quot; TopicConnectionFactoryBindingName TopicBindingName username password configFile&quot;);
        System.exit(1);
    }
    static /* synthetic */ Class class$(final String s){
        try{
            return Class.forName(s);
        }
        catch(ClassNotFoundException ex){
            throw new NoClassDefFoundError(ex.getMessage());
        }
    }
    static{
        JMSSink.logger=Logger.getLogger((JMSSink.class$org$apache$log4j$net$JMSSink==null)?(JMSSink.class$org$apache$log4j$net$JMSSink=class$(&quot;org.apache.log4j.net.JMSSink&quot;)):JMSSink.class$org$apache$log4j$net$JMSSink);
    }
}
</pre>	
    </div> <!-- /container -->

    <script src="resources/js/jquery-1.7.min.js"></script>
    <script src="resources/js/bootstrap.min.js"></script>
    
	<script type='text/javascript' src='resources/libraries/jquery-ui/jquery.ui.widget.js'></script>
	<script type='text/javascript' src='resources/libraries/snippet/jquery.snippet.min.js'></script>
	<script type='text/javascript' src='resources/libraries/snippet/jquery.snippet.java-properties.js'></script>
	<script type='text/javascript' src='resources/libraries/snippet/jquery.snippet.java-manifest.js'></script>
	<script type='text/javascript' src='resources/libraries/sausage/jquery.sausage.min.js'></script>

    
	    
	<script type='text/javascript'>
		$(document).ready(function(){
			$('pre').snippet('java',{style:'ide-eclipse', showNum:true,boxFill:'#ffeeb9', box: '54' });
	
			$("<div id='54-inlines' class='inline-source-hint-group'/>").appendTo('ol.snippet-num li:nth-child(54)');
		
			
$("<a name='3961088'></a><div class='inline-source-comment green'><div class='inline-comment'><div class='inline-comment-heading'><strong class='notification 1'>Ensure that the InitialContext connection properties do not need to change for JBoss</strong></div></div></div>").appendTo('#54-inlines');


		
			$('code[data-code-syntax]').each(function(){
		         var codeSyntax = ($(this).data('code-syntax'));
		         if(codeSyntax) {
		            $(this).parent().snippet(codeSyntax,{style:'ide-eclipse', menu:false, showNum:false});
		         }
			});
			$(window).sausage({ page: 'li.box' });
		}); 
	</script>
    
  </body>
</html>
