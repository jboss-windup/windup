<!DOCTYPE html>
<html lang="en">


  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Source Report for JMSAppender.java</title>
    <link href="resources/css/bootstrap.min.css" rel="stylesheet">
    <link href="resources/css/windup.css" rel="stylesheet" media="screen">
	  <link rel='stylesheet' type='text/css' href='resources/libraries/snippet/jquery.snippet.min.css' />
	  <link rel='stylesheet' type='text/css' href='resources/css/windup-source.css' />
	  <link rel='stylesheet' type='text/css' href='resources/libraries/sausage/sausage.css' />
  </head>
  <body role="document">
    
    <!-- Fixed navbar -->
    <div class="navbar-fixed-top windup-bar" role="navigation">
      <div class="container theme-showcase" role="main">
        <img src="resources/img/windup-logo.png" class="logo"/>
      </div>
    </div>


    <div class="container" role="main">
        <div class="row">
          <div class="page-header page-header-no-border">
            <h1>
              Source Report
              <span class="slash">/</span>
              <small style="margin-left: 20px; font-weight: 100;">jee-example-app-1.0.0.ear/log4j-1.2.6.jar/org/apache/log4j/net/JMSAppender.java</small>
            </h1>
            <div class="navbar navbar-default">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
            </div>
            <div class="navbar-collapse collapse navbar-responsive-collapse">
	     <ol class="breadcrumb top-menu">
		<li><a href="../index.html">All Applications</a></li>
  <li><a href="JEE_Example_App__org_windup_example_jee_example_app_1_0_0_.1.html">JEE Example App (org.windup.example:jee-example-app:1.0.0)</a></li>
  
  <li><a href="JMSAppender_java.2.html">JMSAppender.java</a></li>
  
	     </ol> 
            </div>
            <div class="navbar-collapse collapse navbar-responsive-collapse">
              <ul class="nav navbar-nav">
  <li><a href="JEE_Example_App__org_windup_example_jee_example_app_1_0_0_.1.html">Overview</a></li>
  <li><a href="ignoredfiles_JEE_Example_App__org_windup_example_jee_example_app_1_0_0_.1.html">Ignored Files</a></li>
  <li><a href="nonclassifiedfiles_JEE_Example_App__org_windup_example_jee_example_app_1_0_0_.1.html">Unclassified Files</a></li>
              </ul>
            </div><!-- /.nav-collapse -->
            </div>
          </div>
        </div>
    </div>



    <div class="container theme-showcase" role="main">

    <div class="panel panel-default">
    	<div class="panel-heading">Information</div>
    	<div class="panel-body">
	        <ul>
	          <li>Estimated Story Points: 2</li>
		          <li>
	              		<span class="label label-info">Decompiled Java File</span>
	              		<span class="label label-info">Java Source</span>
	              </li>
            </ul>
        
            <ul>
            </ul>
		</div>
      </div>
    
    

<pre id='source'>package org.apache.log4j.net;

import javax.jms.Session;
import javax.jms.Connection;
import javax.jms.ObjectMessage;
import javax.jms.Message;
import java.io.Serializable;
import org.apache.log4j.spi.LoggingEvent;
import javax.naming.NamingException;
import javax.naming.NameNotFoundException;
import javax.jms.Topic;
import javax.naming.Context;
import javax.jms.TopicConnectionFactory;
import java.util.Hashtable;
import javax.naming.InitialContext;
import java.util.Properties;
import org.apache.log4j.helpers.LogLog;
import javax.jms.TopicPublisher;
import javax.jms.TopicSession;
import javax.jms.TopicConnection;
import org.apache.log4j.AppenderSkeleton;

public class JMSAppender extends AppenderSkeleton{
    String securityPrincipalName;
    String securityCredentials;
    String initialContextFactoryName;
    String urlPkgPrefixes;
    String providerURL;
    String topicBindingName;
    String tcfBindingName;
    String userName;
    String password;
    boolean locationInfo;
    TopicConnection topicConnection;
    TopicSession topicSession;
    TopicPublisher topicPublisher;
    public void setTopicConnectionFactoryBindingName(final String tcfBindingName){
        this.tcfBindingName=tcfBindingName;
    }
    public String getTopicConnectionFactoryBindingName(){
        return this.tcfBindingName;
    }
    public void setTopicBindingName(final String topicBindingName){
        this.topicBindingName=topicBindingName;
    }
    public String getTopicBindingName(){
        return this.topicBindingName;
    }
    public boolean getLocationInfo(){
        return this.locationInfo;
    }
    public void activateOptions(){
        try{
            LogLog.debug(&quot;Getting initial context.&quot;);
            InitialContext initialContext;
            if(this.initialContextFactoryName!=null){
                final Properties properties=new Properties();
                ((Hashtable&lt;String,String&gt;)properties).put(&quot;java.naming.factory.initial&quot;,this.initialContextFactoryName);
                if(this.providerURL!=null){
                    ((Hashtable&lt;String,String&gt;)properties).put(&quot;java.naming.provider.url&quot;,this.providerURL);
                }
                else{
                    LogLog.warn(&quot;You have set InitialContextFactoryName option but not the ProviderURL. This is likely to cause problems.&quot;);
                }
                if(this.urlPkgPrefixes!=null){
                    ((Hashtable&lt;String,String&gt;)properties).put(&quot;java.naming.factory.url.pkgs&quot;,this.urlPkgPrefixes);
                }
                if(this.securityPrincipalName!=null){
                    ((Hashtable&lt;String,String&gt;)properties).put(&quot;java.naming.security.principal&quot;,this.securityPrincipalName);
                    if(this.securityCredentials!=null){
                        ((Hashtable&lt;String,String&gt;)properties).put(&quot;java.naming.security.credentials&quot;,this.securityCredentials);
                    }
                    else{
                        LogLog.warn(&quot;You have set SecurityPrincipalName option but not the SecurityCredentials. This is likely to cause problems.&quot;);
                    }
                }
                initialContext=new InitialContext(properties);
            }
            else{
                initialContext=new InitialContext();
            }
            LogLog.debug(&quot;Looking up [&quot;+this.tcfBindingName+&quot;]&quot;);
            final TopicConnectionFactory topicConnectionFactory=(TopicConnectionFactory)this.lookup(initialContext,this.tcfBindingName);
            LogLog.debug(&quot;About to create TopicConnection.&quot;);
            if(this.userName!=null){
                this.topicConnection=topicConnectionFactory.createTopicConnection(this.userName,this.password);
            }
            else{
                this.topicConnection=topicConnectionFactory.createTopicConnection();
            }
            LogLog.debug(&quot;Creating TopicSession, non-transactional, in AUTO_ACKNOWLEDGE mode.&quot;);
            this.topicSession=this.topicConnection.createTopicSession(false,1);
            LogLog.debug(&quot;Looking up topic name [&quot;+this.topicBindingName+&quot;].&quot;);
            final Topic topic=(Topic)this.lookup(initialContext,this.topicBindingName);
            LogLog.debug(&quot;Creating TopicPublisher.&quot;);
            this.topicPublisher=this.topicSession.createPublisher(topic);
            LogLog.debug(&quot;Starting TopicConnection.&quot;);
            ((Connection)this.topicConnection).start();
            initialContext.close();
        }
        catch(Exception ex){
            super.errorHandler.error(&quot;Error while activating options for appender named [&quot;+super.name+&quot;].&quot;,ex,0);
        }
    }
    protected Object lookup(final Context context,final String s) throws NamingException{
        try{
            return context.lookup(s);
        }
        catch(NameNotFoundException ex){
            LogLog.error(&quot;Could not find name [&quot;+s+&quot;].&quot;);
            throw ex;
        }
    }
    protected boolean checkEntryConditions(){
        String s=null;
        if(this.topicConnection==null){
            s=&quot;No TopicConnection&quot;;
        }
        else if(this.topicSession==null){
            s=&quot;No TopicSession&quot;;
        }
        else if(this.topicPublisher==null){
            s=&quot;No TopicPublisher&quot;;
        }
        if(s!=null){
            super.errorHandler.error(s+&quot; for JMSAppender named [&quot;+super.name+&quot;].&quot;);
            return false;
        }
        return true;
    }
    public synchronized void close(){
        if(super.closed){
            return;
        }
        LogLog.debug(&quot;Closing appender [&quot;+super.name+&quot;].&quot;);
        super.closed=true;
        try{
            if(this.topicSession!=null){
                ((Session)this.topicSession).close();
            }
            if(this.topicConnection!=null){
                ((Connection)this.topicConnection).close();
            }
        }
        catch(Exception t){
            LogLog.error(&quot;Error while closing JMSAppender [&quot;+super.name+&quot;].&quot;,t);
        }
        this.topicPublisher=null;
        this.topicSession=null;
        this.topicConnection=null;
    }
    public void append(final LoggingEvent object){
        if(!this.checkEntryConditions()){
            return;
        }
        try{
            final ObjectMessage objectMessage=((Session)this.topicSession).createObjectMessage();
            if(this.locationInfo){
                object.getLocationInformation();
            }
            objectMessage.setObject((Serializable)object);
            this.topicPublisher.publish((Message)objectMessage);
        }
        catch(Exception ex){
            super.errorHandler.error(&quot;Could not publish message in JMSAppender [&quot;+super.name+&quot;].&quot;,ex,0);
        }
    }
    public String getInitialContextFactoryName(){
        return this.initialContextFactoryName;
    }
    public void setInitialContextFactoryName(final String initialContextFactoryName){
        this.initialContextFactoryName=initialContextFactoryName;
    }
    public String getProviderURL(){
        return this.providerURL;
    }
    public void setProviderURL(final String providerURL){
        this.providerURL=providerURL;
    }
    String getURLPkgPrefixes(){
        return this.urlPkgPrefixes;
    }
    public void setURLPkgPrefixes(final String urlPkgPrefixes){
        this.urlPkgPrefixes=urlPkgPrefixes;
    }
    public String getSecurityCredentials(){
        return this.securityCredentials;
    }
    public void setSecurityCredentials(final String securityCredentials){
        this.securityCredentials=securityCredentials;
    }
    public String getSecurityPrincipalName(){
        return this.securityPrincipalName;
    }
    public void setSecurityPrincipalName(final String securityPrincipalName){
        this.securityPrincipalName=securityPrincipalName;
    }
    public String getUserName(){
        return this.userName;
    }
    public void setUserName(final String userName){
        this.userName=userName;
    }
    public String getPassword(){
        return this.password;
    }
    public void setPassword(final String password){
        this.password=password;
    }
    public void setLocationInfo(final boolean locationInfo){
        this.locationInfo=locationInfo;
    }
    public boolean requiresLayout(){
        return false;
    }
}
</pre>	
    </div> <!-- /container -->

    <script src="resources/js/jquery-1.7.min.js"></script>
    <script src="resources/js/bootstrap.min.js"></script>
    
	<script type='text/javascript' src='resources/libraries/jquery-ui/jquery.ui.widget.js'></script>
	<script type='text/javascript' src='resources/libraries/snippet/jquery.snippet.min.js'></script>
	<script type='text/javascript' src='resources/libraries/snippet/jquery.snippet.java-properties.js'></script>
	<script type='text/javascript' src='resources/libraries/snippet/jquery.snippet.java-manifest.js'></script>
	<script type='text/javascript' src='resources/libraries/sausage/jquery.sausage.min.js'></script>

    
	    
	<script type='text/javascript'>
		$(document).ready(function(){
			$('pre').snippet('java',{style:'ide-eclipse', showNum:true,boxFill:'#ffeeb9', box: '80,77' });
	
			$("<div id='80-inlines' class='inline-source-hint-group'/>").appendTo('ol.snippet-num li:nth-child(80)');
			$("<div id='77-inlines' class='inline-source-hint-group'/>").appendTo('ol.snippet-num li:nth-child(77)');
		
			
$("<a name='3962880'></a><div class='inline-source-comment green'><div class='inline-comment'><div class='inline-comment-heading'><strong class='notification 1'>Ensure that the InitialContext connection properties do not need to change for JBoss</strong></div></div></div>").appendTo('#80-inlines');
			
$("<a name='3963136'></a><div class='inline-source-comment green'><div class='inline-comment'><div class='inline-comment-heading'><strong class='notification 1'>Ensure that the InitialContext connection properties do not need to change for JBoss</strong></div></div></div>").appendTo('#77-inlines');


		
			$('code[data-code-syntax]').each(function(){
		         var codeSyntax = ($(this).data('code-syntax'));
		         if(codeSyntax) {
		            $(this).parent().snippet(codeSyntax,{style:'ide-eclipse', menu:false, showNum:false});
		         }
			});
			$(window).sausage({ page: 'li.box' });
		}); 
	</script>
    
  </body>
</html>
